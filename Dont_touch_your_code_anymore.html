<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Design you code! (and write less of it): Don't touch your code anymore!</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="icon" href="assets/images/UOSSheild_Primary_Violet_RGB.ico" sizes="any"><link rel="icon" href="assets/images/UOSSheild_Primary_Violet_RGB.svg" type="image/svg+xml"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <a href="https://www.sheffield.ac.uk" class="external-link">
          <img alt="University of Sheffield" src="assets/images/UOSLogo_Primary_Violet_RGB.svg"></a>

        <abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>

      </div>
    </div>
    <div class="selector-container">


      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/Dont_touch_your_code_anymore.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="University of Sheffield" src="assets/images/UOSSheild_Primary_Violet_RGB.svg"></div>
    <div class="lesson-title-md">
      Design you code! (and write less of it)
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Design you code! (and write less of it)
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="acknowledgements.html">Acknowledgements</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="" aria-label=""><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Design you code! (and write less of it)
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 80%" class="percentage">
    80%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 80%" aria-valuenow="80" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/Dont_touch_your_code_anymore.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="Writing_clean_code.html">2. The Zen of Python</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="Principles.html">3. Principles of Code design</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="Code_structure.html">4. Code structure</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Don't touch your code anymore!
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#configuration-files">Configuration files</a></li>
<li><a href="#using-command-line-interfaces">Using command line interfaces</a></li>
<li><a href="#final-exercice-mixing-command-line-interface-and-configuration-file">Final exercice: Mixing command line interface and configuration
file</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="acknowledgements.html">Acknowledgements</a></li><li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="Code_structure.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="Code_structure.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Code structure
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Don't touch your code anymore!</h1>
        <p>Last updated on 2024-08-05 |

        <a href="https://github.com/Romain-Thomas-Shef/FAIR_Code_design/edit/main/episodes/Dont_touch_your_code_anymore.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can you modify your code configuration without touching it?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Learn how to set up configuration files using a simple INI file</li>
<li>Be able to create simple command line interfaces with argparse</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><p>Research software is often based on a trial-error or trial-trial
loops. You will often find yourself trying to rerun a code with
different parameters to try different configuration of your experiment.
So far what we have seen deals with the design of the code itself and
how to make it cleaner, more readable and maintainable. BUT! what if you
need to try something new by changing few parameters of your code? You
will need to go and change the code itself! And it is very likely that
you will do this a few times (or a lot!). Along the way, and unless you
are able to track very well all your trials, you will probably loose
track of some of them. In addition, modifying endlessly the code
increase greatly the risk of introducing errors…</p>
<p>In order to avoid such problems we are going to see a couple of
options that are easily available and implementable:</p>
<ul><li>Configuration files</li>
<li>Command line interface</li>
</ul></section><section><h2 class="section-heading" id="configuration-files">Configuration files<a class="anchor" aria-label="anchor" href="#configuration-files"></a>
<a class="anchor" aria-label="anchor" href="#configuration-files"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="advantages-of-using-configuration-files">Advantages of using configuration files<a class="anchor" aria-label="anchor" href="#advantages-of-using-configuration-files"></a></h3>
<p>Using configuration files in a research context offers several
specific benefits that can greatly enhance the efficiency,
reproducibility, and manageability of research projects. Here are the
key reasons why configuration files are beneficial in a research
setting:</p>
<ul><li><p><strong>Reproducibility</strong>: Configuration files ensure that
experiments can be easily replicated by maintaining consistent settings
across different runs. This is critical for verifying results and peer
review.</p></li>
<li><p><strong>Parameter Managemen</strong>t: Research often involves
experimenting with various parameters. Configuration files allow
researchers to manage and tweak these parameters without altering the
core codebase, enabling easier experimentation and
optimization.</p></li>
<li><p><strong>Collaboration</strong>: Research projects often involve
collaboration between multiple researchers. Configuration files provide
a clear and centralized way to share settings, making it easier for team
members to understand and modify the setup as needed.</p></li>
<li><p><strong>Documentation</strong>: Well-structured configuration
files serve as documentation for the experimental setup. They provide a
clear and organized record of the settings used, which is crucial for
understanding and interpreting results.</p></li>
<li><p><strong>Version Control</strong>: Configuration files can be
versioned alongside the code using version control systems like Git.
This makes it easy to track changes in experimental setups over time and
understand the impact of these changes on the results.</p></li>
</ul></div>
<div class="section level3">
<h3 id="how-to-build-configuration-files-what-library-should-i-use">How to build configuration files? What library should I use?<a class="anchor" aria-label="anchor" href="#how-to-build-configuration-files-what-library-should-i-use"></a></h3>
<p>As it is often the case in Python, multiple options are
available:</p>
<ul><li>
<a href="https://en.wikipedia.org/wiki/INI_file" class="external-link">INI</a> Files are
easy to read and parse. The module used to load these files is <a href="https://docs.python.org/3/library/configparser.html" class="external-link">configparser</a>
and part of the <a href="https://docs.python.org/3/library/index.html" class="external-link">Python standard
Library</a>.</li>
</ul><pre><code>[section1]
key1 = value1
key2 = value2

#Comments

[section2]
key1 = value1


[Section3]
key = value3
    multiline</code></pre>
<p>INI files are structured as (case sensitive) sections in which you
can list keyword/value pairs (like for a dictionary) separated by either
the <code>=</code> or <code>:</code> signs. Values can span multiple
lines and comments are accepted as long as the extra lines are indented
with respect to the first line.</p>
<ul><li>JSON: Originally developed for JavaScript, they are very popular in
web applications. The module to read these files is <a href="https://docs.python.org/3/library/json.html#module-json" class="external-link">json</a>
and also part of the standard library.</li>
</ul><pre><code>{
  "section1": {
    "key1": "value1",
    "key2": "value2"
  },
  "section2": {
    "key1": "value1"
  }
}</code></pre>
<p>JSON files are also structured as section and keyword/value pairs.
JSON files start with an opening brace <code>{</code> and end with a
closing brace <code>}</code>. Then each section comes with its name
followed by <code>:</code>. Then key/value pairs are listed within
braces (one for each section). Nevertheless, comments are not
allowed.</p>
<ul><li>YAML Files: are also a popular format (used for github action for
example). In order to read (and write) YAML files, you will need to
install a third party package called <a href="https://pyyaml.org/" class="external-link">PyYAML</a>.</li>
</ul><pre><code><span><span class="va">section1</span><span class="op">:</span></span>
<span>  <span class="va">key1</span><span class="op">:</span> <span class="va">value1</span></span>
<span>  <span class="va">key2</span><span class="op">:</span> <span class="va">value2</span></span>
<span></span>
<span><span class="va">section2</span><span class="op">:</span></span>
<span>  <span class="va">key1</span><span class="op">:</span> <span class="va">value1</span></span>
<span></span>
<span><span class="co"># Comments</span></span></code></pre>
<p>YAML files work also with sections and keyword/value pairs.</p>
</div>
<div class="section level3">
<h3 id="configparser-loading-and-writing-config-files">Configparser: loading and writing config files<a class="anchor" aria-label="anchor" href="#configparser-loading-and-writing-config-files"></a></h3>
<p>In the following we will be using INI files. We will start by a
simple exercice on writing a configuration file, manually.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Using the text editor of your choice, create an INI file with three
sections: simulation, environment and initial conditions. In the first
section, to parameters are given: <code>time_step</code> set at 0.01s
and <code>total_time</code> set at 100.0s. The environment section also
has two parameters with <code>gravity</code> at 9.81 and
<code>air_resistance</code> at 0.02. Finally the initial conditions are:
<code>velocity</code> at 10.0 km/s, <code>angle</code> at 45 degrees and
<code>height</code> at 1 m</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Creating a file <code>'config.ini'</code> with the following
content.</p>
<pre><code>[simulation]
time_step = 0.01
total_time = 100.0

[environment]
gravity = 9.81
air_resistance = 0.02

[initial_conditions]
velocity = 10.0
angle = 45.0
height = 0.0</code></pre>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="reading-configuration-files">Reading configuration files<a class="anchor" aria-label="anchor" href="#reading-configuration-files"></a></h4>
<p>Reading an INI file is very easy. It requires the use of the <a href="https://docs.python.org/3/library/configparser.html" class="external-link">Configparser</a>
library. You do not need to install it because it comes as part of the
standard library. When you want to read a config file you will need to
import it and create a parser object which will then be used to read the
file we created just above, as follows:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">##Import the library</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="im">import</span> configparser </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">##Create the parser object</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>parser <span class="op">=</span> configparser.ConfigParser()</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">##Read the configuration file</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>parser.read(<span class="st">'config.ini'</span>)</span></code></pre>
</div>
<p>From there you can access everything that is in the configuration
file. Firstly you can access the section names and check if sections are
there or not (useful to check that the config file is compliant with
what you would expect):</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(parser.sections())</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>[<span class="st">'simulation'</span>, <span class="st">'environment'</span>, <span class="st">'initial_conditions'</span>] </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span><span class="bu">print</span>(parser.has_section(<span class="st">'simulation'</span>))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span><span class="bu">print</span>(parser.has_section(<span class="st">'Finalstate'</span>))</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="va">False</span></span></code></pre>
</div>
<p>Eventually, you will need to extract the values in the configuration
file. You can get all the keys inside a section at once:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> options <span class="op">=</span> parser.options(<span class="st">'simulation'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>[<span class="st">'time_step'</span>, <span class="st">'total_time'</span>]</span></code></pre>
</div>
<p>You can also extract everything at once, in that caseeach couple
key/value will be called an <em>item</em>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> items_in_simulation <span class="op">=</span> parser.items(<span class="st">'simulation'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(items_in_simulation)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>[(<span class="st">'time_step'</span>, <span class="st">'0.01'</span>), (<span class="st">'total_time'</span>, <span class="st">'100.0'</span>)]</span></code></pre>
</div>
<p>That method will return a <em>list</em> of <em>tuples</em>, each
<em>tuple</em> will contain the couple key/value. Values will always be
of type string.</p>
<p>Finally, you can access directly values of keys inside a given
section like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> time_step <span class="op">=</span> parser[<span class="st">'simulation'</span>][<span class="st">'time_step'</span>]</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(time_step)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fl">0.01</span></span></code></pre>
</div>
<p>By default, <em>ALL</em> values will be a <em>string</em>. Another
option is to use the method <code>.get()</code>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> time_step_with_get <span class="op">=</span> parser.get(<span class="st">'simulation'</span>, <span class="st">'time_step'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(time_step_with_get)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fl">0.01</span></span></code></pre>
</div>
<p>It will also be giving a string…And that can be annoying when you
have some other types because you will have to convert everything to the
right type. Fortunately, other methods are available:</p>
<ul><li>
<code>.getint()</code> will extract the keyword and convert it to
integer</li>
<li>
<code>.getfloat()</code> will extract the keyword and convert it to
a float</li>
<li>
<code>.getboolean()</code> will extract the keyword and convert it
to a boolean. Interestingly, you it return <code>True</code> is the
value is <code>1</code>, <code>yes</code>, <code>true</code> or
<code>on</code>, while it will return False if the value is
<code>0</code>, <code>no</code>, <code>false</code>, or
<code>off</code>.</li>
</ul></div>
<div class="section level4">
<h4 id="writing-configuration-files">Writing configuration files<a class="anchor" aria-label="anchor" href="#writing-configuration-files"></a></h4>
<p>In some occasions it might also be interesting to be able to write
configuration file programatically. <strong>Configparser</strong> allows
the user to write INI files as well. As for reading them, everything
starts by importing the module and creating an object:</p>
<pre><code>#Let's import the ConfigParser object directly
from configparser import ConfigParser

# And create a config object
config = ConfigParser()</code></pre>
<p>Creating a configuration is equivalent of creating a
dictionaries:</p>
<pre><code>config['simulation'] = {'time_step': 1.0, 'total_time': 200.0}
config['environment'] = {'gravity': 9.81, 'air_resistance': 0.02}
config['initial_conditions'] = {'velocity': 5.0, 'angle': 30.0, 'height': 0.5}</code></pre>
<p>And finally you will have to save it:</p>
<pre><code>with open('config_file_program.ini', 'w') as configfile: ##This open the condif_file_program.ini in write mode
    config.write(configfile)</code></pre>
<p>After running that piece of code, you will end with a new file called
<code>config_file_program.ini</code> with the following content:</p>
<pre><code>[simulation]
time_step = 1.0
total_time = 200.0

[environment]
gravity = 9.81
air_resistance = 0.02

[initial_conditions]
velocity = 5.0
angle = 30.0
height = 0.5</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="using-command-line-interfaces">Using command line interfaces<a class="anchor" aria-label="anchor" href="#using-command-line-interfaces"></a>
<a class="anchor" aria-label="anchor" href="#using-command-line-interfaces"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="definition-advantages">Definition &amp; advantages<a class="anchor" aria-label="anchor" href="#definition-advantages"></a></h3>
<p>A Command Line Interface (CLI) is a text-based interface used to
interact with software and operating systems. It allows users to type
commands into a terminal or command prompt to perform specific tasks,
ranging from file manipulation to running scripts or programs.</p>
<p>When writing research software CLIs are particularly suitable:</p>
<ul><li><p><strong>Configuration</strong>: Using CLI it is easy to modify
the configuration of a software without having to touch the source
code.</p></li>
<li><p><strong>Batch Processing</strong>: Researchers often need to
process large datasets or run simulations multiple times. CLI commands
can be easily scripted to automate these tasks, saving time and reducing
the potential for human error.</p></li>
<li><p><strong>Quick Execution</strong>: Experienced users can perform
complex tasks more quickly with a CLI compared to navigating through a
GUI.</p></li>
<li><p><strong>Adding New Features</strong>: Adding new arguments and
options is straightforward, making it easy to extend the functionality
of your software as requirements evolve.</p></li>
<li><p><strong>Documentation</strong>: CLI helps document the
functionality of your script through the <code>help</code> command,
making it clearer how different options and parameters affect the
outcome.</p></li>
<li><p><strong>Use in HPCs</strong>: HPCs are often accessible through
terminal making command line interfaces particularly useful to start
codes from HPCs.</p></li>
</ul></div>
<div class="section level3">
<h3 id="creating-a-command-line-interface-in-python">Creating a command line interface in Python<a class="anchor" aria-label="anchor" href="#creating-a-command-line-interface-in-python"></a></h3>
<p>In Python, there is a very nice module called <a href="https://docs.python.org/3/library/argparse.html" class="external-link">argparse</a>. It
allows to write in a very limited amount of lines a nice command line
user interface. Again, that module is part of the standard library so
you do not need to install anything.</p>
<p>As for the configuration files, we must start by importing the module
and creating a parser object. The parser object can take a few
arguments, the main ones are:</p>
<ul><li>
<code>prog</code>: The name of the program</li>
<li>
<code>description</code>: A short description of the program.</li>
<li>
<code>epilog</code>: Text displayed at the bottom of the help</li>
</ul><p>We would proceed as follows:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co">###import the library</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">###create the parser object</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>parser <span class="op">=</span> argparse.ArgumentParser(prog<span class="op">=</span><span class="st">'My program'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                                 description<span class="op">=</span><span class="st">'This program is an example of command line interface in Python'</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a> 				 epilog<span class="op">=</span><span class="st">'Author: R. Thomas, 2024, UoS'</span>)</span></code></pre>
</div>
<p>Now we need to add arguments. To do so we need to use the
<code>add_argument</code> method, part of the parser object:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co">###Add positional argument</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>parser.add_argument(<span class="st">'filename'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>parser.add_argument(<span class="st">'outputdir'</span>)</span></code></pre>
</div>
<p>Using this type of argument (‘filename’ and ‘outputdir’) will make
them mandatory. The user will have to pass a filename AND an output
directory to the program. It is worth mentioning that they will have to
be passed in the right order by the user. It is useful sometimes to
create optional arguments. This will be done using a <code>-</code> sign
as first character in the name of the argument:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co">###Add optional arguments</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>parser.add_argument(<span class="st">'-s'</span>, <span class="st">'--start'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>parser.add_argument(<span class="st">'-e'</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>parser.add_argument(<span class="st">'--color'</span>)</span></code></pre>
</div>
<p>You can either use the single dash (‘-s’), or double dash (‘–color’)
or both. When given two options to call an argument, the user will have
to make a choice on how to call it.</p>
<p>It is possible to use extra options to define arguments, we list a
few here:</p>
<ul><li><p><code>actions</code>: this options allows you to do</p></li>
<li><p><code>default</code>: This allows you to define a default value
for the argument. In the case thr argument will not be used by the user,
the default value will be selected:
<code>parser.add_argument('--color', default='blue')</code>.</p></li>
<li><p><code>type</code>: By default, the argument will be extracted as
strings. Nevertheless, it is possible to have them interpreted as other
types using the <code>type</code> argument:
<code>parser.add_argument('-i', type=int)</code>. It the user passes a
value that cannot be converted to the expected type an error will be
returned.</p></li>
<li><p><code>choices</code>: If you want to restrict the values an
argument can take, you can use the <code>choice</code> option to add
this contraints:
<code>parser.add_argument('--color', choiced=['blue', 'red', 'green'])</code>.
If the user pass ‘purple’ as value, an error will be raised.</p></li>
<li><p><code>help</code>: finally, and it is probably the most important
option, you can provide a short description of the argument:
<code>parser.add_argument('--color', help='Color of the curve displayed in the plot')</code></p></li>
</ul><p>Finally you must be able to retrieve all the argument values:</p>
<pre><code><span><span class="co">###retrieve all arguments</span></span>
<span><span class="va">args</span> <span class="op">=</span> <span class="fu">parser.parse_args</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">print</span><span class="op">(</span><span class="va">args.start</span>, <span class="va">args.e</span>, <span class="va">args.color</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="final-exercice-mixing-command-line-interface-and-configuration-file">Final exercice: Mixing command line interface and configuration
file<a class="anchor" aria-label="anchor" href="#final-exercice-mixing-command-line-interface-and-configuration-file"></a>
<a class="anchor" aria-label="anchor" href="#final-exercice-mixing-command-line-interface-and-configuration-file"></a></h2>
<hr class="half-width"><p>For this last part of the final lecture we will combine both package
we just reviewed: <code>argparse</code> and <code>configparser</code>.
Find the instructions below:</p>
<div id="discussion2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#discussion2"></a>
</h3>
<div class="callout-content">
<p>The program that you will create will take an optional configuration
file. If not configuration file is given, the program will load an
internal one that you can find <a href="https://github.com/Romain-Thomas-Shef/FAIR_Code_design/blob/main/final_exercice/config_default.conf" class="external-link">here</a>
(you need to put this next to your code). To do this you will create an
optional argument <code>--file</code>.</p>
<p>arguments:</p>
<ul><li>
<code>--name</code>: This argument requires a name. If it is used,
the value given will replace the default name in the configuration
file.</li>
<li>
<code>--save</code>: This argument require a directory as value. If
used, the configuration is saved into that directory under the name
<code>X_config.ini</code> where <code>X</code> is the name of the user
found in the configuration file OR the one given by the
<code>--name</code> argument.</li>
</ul></div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>AHAHAHAHA you really though it would be that easy…. :)</p>
</div>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="Code_structure.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="Code_structure.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Code structure
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-2">
        <a href="https://docs.hpc.shef.ac.uk/en/latest/stanage/index.html" class="external-link">
          <img alt="Stanage HPC" src="https://docs.hpc.shef.ac.uk/en/latest/_images/Stanage_Black.png" style="width: 100%;"></a>
        <p><a href="https://sites.google.com/sheffield.ac.uk/research-training/research-training" class="external-link">Research Computing Training Home</a></p>
			</div>
			<div class="col-md-5">
        <p>Lesson developed by <a href="https://rse.shef.ac.uk" class="external-link">RSE</a> &amp; <a href="https://www.sheffield.ac.uk/it-services/research" class="external-link">RIT</a></p>
        <p>

          <a href="https://github.com/Romain-Thomas-Shef/FAIR_Code_design/edit/main/episodes/Dont_touch_your_code_anymore.md" class="external-link">Edit on GitHub</a>


        | <a href="https://github.com/Romain-Thomas-Shef/FAIR_Code_design/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/Romain-Thomas-Shef/FAIR_Code_design/" class="external-link">Source</a>
        </p>
		<p>
          <a href="https://github.com/Romain-Thomas-Shef/FAIR_Code_design/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:romain.thomas@sheffield.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a> | <a href="CODE_OF_CONDUCT.html">Code of Conduct</a>
        </p>
		</div>
		<div class="col-md-5">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>


        <!--<p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY 4.0</a> by <a href="https://carpentries.org/">The Carpentries</a></p>-->
        <!--<p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6">pegboard (0.7.6)</a>, and <a href="https://github.com/RSE-Sheffield/uos-varnish/tree/main">varnish (1.0.2.9000)</a></p>-->
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5" class="external-link">sandpaper (0.16.5)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>,
      and <a href="https://github.com/RSE-Sheffield/uos-varnish/tree/main" class="external-link">varnish (1.0.2.9000) [UoS fork]</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://Romain-Thomas-Shef.github.io/FAIR_Code_design/Dont_touch_your_code_anymore.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, lesson, The Carpentries, FAIR4RS",
  "name": "Don't touch your code anymore!",
  "creativeWorkStatus": "active",
  "url": "https://Romain-Thomas-Shef.github.io/FAIR_Code_design/Dont_touch_your_code_anymore.html",
  "identifier": "https://Romain-Thomas-Shef.github.io/FAIR_Code_design/Dont_touch_your_code_anymore.html",
  "dateCreated": "2024-06-11",
  "dateModified": "2024-08-05",
  "datePublished": "2024-08-09"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

